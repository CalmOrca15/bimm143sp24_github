<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shreyas Sankaranarayanan">

<title>Lab 9 - Halloween Candy Mini-Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="lab09_files/libs/clipboard/clipboard.min.js"></script>
<script src="lab09_files/libs/quarto-html/quarto.js"></script>
<script src="lab09_files/libs/quarto-html/popper.min.js"></script>
<script src="lab09_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lab09_files/libs/quarto-html/anchor.min.js"></script>
<link href="lab09_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lab09_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lab09_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lab09_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lab09_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="lab09_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="lab09_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="lab09_files/libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="lab09_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="lab09_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="lab09_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="lab09_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="lab09_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="lab09_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 9 - Halloween Candy Mini-Project</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Shreyas Sankaranarayanan </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="project-context" class="level2">
<h2 class="anchored" data-anchor-id="project-context">Project Context</h2>
<p>In this report we will be conducting and documenting our analysis on the candy-data csv provided by the new organization FiveThirtyEight. We will be trying to determine what exactly makes a candy popular.</p>
<p>In order to do so we must first import the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>candy <span class="ot">&lt;-</span> <span class="st">"candy-data.csv"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>candy.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(candy, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(candy.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             chocolate fruity caramel peanutyalmondy nougat crispedricewafer
100 Grand            1      0       1              0      0                1
3 Musketeers         1      0       0              0      1                0
One dime             0      0       0              0      0                0
One quarter          0      0       0              0      0                0
Air Heads            0      1       0              0      0                0
Almond Joy           1      0       0              1      0                0
             hard bar pluribus sugarpercent pricepercent winpercent
100 Grand       0   1        0        0.732        0.860   66.97173
3 Musketeers    0   1        0        0.604        0.511   67.60294
One dime        0   0        0        0.011        0.116   32.26109
One quarter     0   0        0        0.011        0.511   46.11650
Air Heads       0   0        0        0.906        0.511   52.34146
Almond Joy      0   1        0        0.465        0.767   50.34755</code></pre>
</div>
</div>
</section>
<section id="data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="data-analysis">Data Analysis</h2>
<blockquote class="blockquote">
<p>Q1. How many different candy types are in this dataset?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>diffcandy <span class="ot">&lt;-</span> <span class="fu">nrow</span>(candy.data)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>diffcandy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 85</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q2. How many fruity candy types are in the data set?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(candy.data<span class="sc">$</span>fruity)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 38</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q3. What is your favorite candy in the dataset and what is it’s winpercent value?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>candy.data[<span class="st">"Welch's Fruit Snacks"</span>,]<span class="sc">$</span>winpercent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44.37552</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q4. What is the winpercent value for “Kit Kat”?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>candy.data[<span class="st">"Kit Kat"</span>,]<span class="sc">$</span>winpercent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76.7686</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q5. What is the winpercent value for “Tootsie Roll Snack Bars”?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>candy.data[<span class="st">"Tootsie Roll Snack Bars"</span>,]<span class="sc">$</span>winpercent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 49.6535</code></pre>
</div>
</div>
<p>Sidenote: Attempting to use skimr on the csv</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>skimcandy <span class="ot">&lt;-</span> <span class="fu">skim</span>(candy.data)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>skimcandy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">candy.data</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">85</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 11%">
<col style="width: 15%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">chocolate</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
<tr class="even">
<td style="text-align: left;">fruity</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
<tr class="odd">
<td style="text-align: left;">caramel</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">peanutyalmondy</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nougat</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">crispedricewafer</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hard</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">bar</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pluribus</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">sugarpercent</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: left;">▇▇▇▇▆</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pricepercent</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: left;">▇▇▇▇▆</td>
</tr>
<tr class="even">
<td style="text-align: left;">winpercent</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">50.32</td>
<td style="text-align: right;">14.71</td>
<td style="text-align: right;">22.45</td>
<td style="text-align: right;">39.14</td>
<td style="text-align: right;">47.83</td>
<td style="text-align: right;">59.86</td>
<td style="text-align: right;">84.18</td>
<td style="text-align: left;">▃▇▆▅▂</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(candy.data<span class="sc">$</span>winpercent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22.44534</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q6. Is there any variable/column that looks to be on a different scale to the majority of the other columns in the dataset?</p>
</blockquote>
<p>When analyzing the skimcandy dataset which utilizes the <code>skimr</code> package to create a comprehensive view of the csv. This value seems to be the <code>winpercent</code> variable/column.</p>
<blockquote class="blockquote">
<p>Q7. What do you think a zero and one represent for the candy$chocolate column?</p>
</blockquote>
<p>A zero represents that there is no chocolate in the corresponding candy while a one indicates there is</p>
<blockquote class="blockquote">
<p>Q8. Plot a histogram of winpercent values</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(candy.data, <span class="fu">aes</span>(<span class="at">x =</span> candy.data[,<span class="dv">1</span>], candy.data<span class="sc">$</span>winpercent))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `candy.data$winpercent` is discouraged.
ℹ Use `winpercent` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lab09_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(candy.data<span class="sc">$</span>winpercent)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(candy.data<span class="sc">$</span>winpercent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab09_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Q9. Is the distribution of winpercent values symmetrical?</p>
</blockquote>
<p>No, it is not as seen above</p>
<blockquote class="blockquote">
<p>Q10.Is the center of the distribution above or below 50%?</p>
</blockquote>
<p>Below 50%</p>
<blockquote class="blockquote">
<p>Q11. On average is chocolate candy higher or lower ranked than fruit candy?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>avgchocrank <span class="ot">&lt;-</span> candy.data<span class="sc">$</span>winpercent[<span class="fu">which</span>(candy.data<span class="sc">$</span>chocolate <span class="sc">==</span> <span class="dv">1</span>)]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>avgfruitrank <span class="ot">&lt;-</span> candy.data<span class="sc">$</span>winpercent[<span class="fu">which</span>(candy.data<span class="sc">$</span>fruity <span class="sc">==</span> <span class="dv">1</span>)]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(avgchocrank)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 60.92153</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(avgfruitrank)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44.11974</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q12. Is this difference statistically singificant?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(avgfruitrank,avgchocrank)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  avgfruitrank and avgchocrank
t = -6.2582, df = 68.882, p-value = 2.871e-08
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -22.15795 -11.44563
sample estimates:
mean of x mean of y 
 44.11974  60.92153 </code></pre>
</div>
</div>
<p>The p-value is significantly lower than 0.05 showing that the difference is statistically significant.</p>
<blockquote class="blockquote">
<p>Q13. What are the five least liked candy types in this set?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(candy.data[<span class="fu">order</span>(candy.data<span class="sc">$</span>winpercent, <span class="at">decreasing =</span> <span class="cn">FALSE</span>),], <span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   chocolate fruity caramel peanutyalmondy nougat
Nik L Nip                  0      1       0              0      0
Boston Baked Beans         0      0       0              1      0
Chiclets                   0      1       0              0      0
Super Bubble               0      1       0              0      0
Jawbusters                 0      1       0              0      0
                   crispedricewafer hard bar pluribus sugarpercent pricepercent
Nik L Nip                         0    0   0        1        0.197        0.976
Boston Baked Beans                0    0   0        1        0.313        0.511
Chiclets                          0    0   0        1        0.046        0.325
Super Bubble                      0    0   0        0        0.162        0.116
Jawbusters                        0    1   0        1        0.093        0.511
                   winpercent
Nik L Nip            22.44534
Boston Baked Beans   23.41782
Chiclets             24.52499
Super Bubble         27.30386
Jawbusters           28.12744</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q14. What are the top 5 all time favorite candy types out of this set?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(candy.data[<span class="fu">order</span>(candy.data<span class="sc">$</span>winpercent, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),], <span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          chocolate fruity caramel peanutyalmondy nougat
Reese's Peanut Butter cup         1      0       0              1      0
Reese's Miniatures                1      0       0              1      0
Twix                              1      0       1              0      0
Kit Kat                           1      0       0              0      0
Snickers                          1      0       1              1      1
                          crispedricewafer hard bar pluribus sugarpercent
Reese's Peanut Butter cup                0    0   0        0        0.720
Reese's Miniatures                       0    0   0        0        0.034
Twix                                     1    0   1        0        0.546
Kit Kat                                  1    0   1        0        0.313
Snickers                                 0    0   1        0        0.546
                          pricepercent winpercent
Reese's Peanut Butter cup        0.651   84.18029
Reese's Miniatures               0.279   81.86626
Twix                             0.906   81.64291
Kit Kat                          0.511   76.76860
Snickers                         0.651   76.67378</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q15. Make a first barplot of candy ranking based on winpercent values.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(candy.data) <span class="sc">+</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(candy.data<span class="sc">$</span>winpercent, <span class="fu">rownames</span>(candy.data)) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `candy.data$winpercent` is discouraged.
ℹ Use `winpercent` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lab09_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Q16. This is quite ugly, use the reorder() function to get the bars sorted by winpercent?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(candy.data) <span class="sc">+</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(winpercent, <span class="fu">reorder</span>(<span class="fu">rownames</span>(candy.data), winpercent)) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab09_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"mybarplot.png"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s make it cleaner</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>my_cols<span class="ot">=</span><span class="fu">rep</span>(<span class="st">"grey"</span>, <span class="fu">nrow</span>(candy.data))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>my_cols[<span class="fu">as.logical</span>(candy.data<span class="sc">$</span>chocolate)] <span class="ot">=</span> <span class="st">"brown"</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>my_cols[<span class="fu">as.logical</span>(candy.data<span class="sc">$</span>bar)] <span class="ot">=</span> <span class="st">"dodgerblue"</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>my_cols[<span class="fu">as.logical</span>(candy.data<span class="sc">$</span>fruity)] <span class="ot">=</span> <span class="st">"hotpink"</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(candy.data) <span class="sc">+</span> </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(winpercent, <span class="fu">reorder</span>(<span class="fu">rownames</span>(candy.data), winpercent)) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> my_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab09_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Q17. What is the worst ranked chocolate candy?</p>
</blockquote>
<p>According to the plot above and the code below, Sixlets are the worst ranked chocolate candy</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>wccand <span class="ot">&lt;-</span> <span class="fu">subset</span>(candy.data, candy.data<span class="sc">$</span>chocolate <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>sortwccand <span class="ot">&lt;-</span> wccand[<span class="fu">order</span>(wccand<span class="sc">$</span>winpercent, <span class="at">decreasing =</span> <span class="cn">FALSE</span>),]</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sortwccand, <span class="at">n=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        chocolate fruity caramel peanutyalmondy nougat crispedricewafer hard
Sixlets         1      0       0              0      0                0    0
        bar pluribus sugarpercent pricepercent winpercent
Sixlets   0        1         0.22        0.081     34.722</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q18. What is the best ranked fruity candy?</p>
</blockquote>
<p>According to the plot above and the code below, Starburst are the best ranked fruity candy</p>
<blockquote class="blockquote">
<p>Q19. Which candy type is the highest ranked in terms of winpercent for the least money - i.e.&nbsp;offers the most bang for your buck?</p>
</blockquote>
<p>Reese’s Miniatures is highest ranked for winpercent but also is one of the cheapest.</p>
<blockquote class="blockquote">
<p>Q20. What are the top 5 most expensive candy types in the dataset and of these which is the least popular?</p>
</blockquote>
<p>NiklNip as it is the least like but the most expensive</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ord <span class="ot">&lt;-</span> <span class="fu">order</span>(candy.data<span class="sc">$</span>pricepercent, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>( candy.data[ord,<span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">12</span>)], <span class="at">n=</span><span class="dv">5</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         pricepercent winpercent
Nik L Nip                       0.976   22.44534
Nestle Smarties                 0.976   37.88719
Ring pop                        0.965   35.29076
Hershey's Krackel               0.918   62.28448
Hershey's Milk Chocolate        0.918   56.49050</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>wccand2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(candy.data, candy.data<span class="sc">$</span>fruity <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>sortwccand <span class="ot">&lt;-</span> wccand2[<span class="fu">order</span>(wccand2<span class="sc">$</span>winpercent, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sortwccand, <span class="at">n=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          chocolate fruity caramel peanutyalmondy nougat crispedricewafer hard
Starburst         0      1       0              0      0                0    0
          bar pluribus sugarpercent pricepercent winpercent
Starburst   0        1        0.151         0.22   67.03763</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># How about a plot of price vs win</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(candy.data) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(winpercent, pricepercent, <span class="at">label=</span><span class="fu">rownames</span>(candy.data)) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col=</span>my_cols) <span class="sc">+</span> </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">col=</span>my_cols, <span class="at">size=</span><span class="fl">3.3</span>, <span class="at">max.overlaps =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ggrepel: 53 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lab09_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="analyszing-correlation-structure" class="level2">
<h2 class="anchored" data-anchor-id="analyszing-correlation-structure">Analyszing correlation structure</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.92 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">## corrplot 0.90 loaded</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>cij <span class="ot">&lt;-</span> <span class="fu">cor</span>(candy.data                                                                                                                                                    )</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cij)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab09_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Q22. Examining this plot what two variables are anti-correlated (i.e.&nbsp;have minus values)?</p>
</blockquote>
<p>Chocolate and fruity are most anticorrelated &gt; Q23. Similarly, what two variables are most positively correlated?</p>
<p>Chocolate and winpercent are most positively correlated</p>
</section>
<section id="conducting-principle-component-analysis" class="level2">
<h2 class="anchored" data-anchor-id="conducting-principle-component-analysis">6. Conducting Principle Component Analysis</h2>
<p>We will perform a PCA of the candy. Key-question: Do we need to scale for PCA? Answer: Yes, as we have values that are rated on diff scales.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(candy.data, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2    PC3     PC4    PC5     PC6     PC7
Standard deviation     2.0788 1.1378 1.1092 1.07533 0.9518 0.81923 0.81530
Proportion of Variance 0.3601 0.1079 0.1025 0.09636 0.0755 0.05593 0.05539
Cumulative Proportion  0.3601 0.4680 0.5705 0.66688 0.7424 0.79830 0.85369
                           PC8     PC9    PC10    PC11    PC12
Standard deviation     0.74530 0.67824 0.62349 0.43974 0.39760
Proportion of Variance 0.04629 0.03833 0.03239 0.01611 0.01317
Cumulative Proportion  0.89998 0.93832 0.97071 0.98683 1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>pca<span class="sc">$</span>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                    PC1           PC2          PC3         PC4
100 Grand                   -3.81986175 -0.5935787670 -2.186308676 -2.37159574
3 Musketeers                -2.79602364 -1.5196062111  1.412198551  0.69943868
One dime                     1.20258363  0.1718120657  2.060771178 -1.20067824
One quarter                  0.44865378  0.4519735621  1.476492844 -1.00177141
Air Heads                    0.70289922 -0.5731343263 -0.929389343  0.41245656
Almond Joy                  -2.46833834  0.7035501120  0.858108916  0.57249739
Baby Ruth                   -4.10531223 -2.1000967736  1.347834706  1.85505225
Boston Baked Beans           0.71385813  1.2098216537  0.941899950  1.10219913
Candy Corn                   1.01357204  0.2834319621 -0.840681586  0.83664703
Caramel Apple Pops           0.81049645 -1.6960889498 -0.207020586 -0.30186567
Charleston Chew             -2.15436587 -1.9304213037  1.675469334  0.46999498
Chewey Lemonhead Fruit Mix   1.65268482  0.0726434944 -0.909617411  0.58609915
Chiclets                     2.38180817  0.4430926071  1.000422079 -0.59998577
Dots                         1.51249936  0.1623958592 -0.967135199  0.63622661
Dum Dums                     2.14430933 -1.8388386160 -0.385372660 -0.14796280
Fruit Chews                  2.26133763  0.5818322520  0.978626618 -0.39164187
Fun Dip                      1.82383348 -1.7828662094 -0.719415821 -0.08544003
Gobstopper                   1.96047812 -1.0584680267 -1.873874385  0.84237208
Haribo Gold Bears            1.33360746  0.5892699921 -0.431929774  0.33530766
Haribo Happy Cola            1.11167365  0.6257697808  0.054459647  0.16024129
Haribo Sour Bears            1.46152952  0.5073691482 -0.379443632  0.28956535
Haribo Twin Snakes           1.66849016  0.3748646265 -0.294528131  0.21556045
Hershey's Kisses             0.37722675  1.5654519145  1.104739528 -0.30451907
Hershey's Krackel           -3.04788356  0.6850792787 -1.154357778 -2.79294516
Hershey's Milk Chocolate    -2.11696417  0.2504568891  0.218316614 -0.64942872
Hershey's Special Dark      -2.17850376  0.2898570052  0.193067056 -0.62742342
Jawbusters                   2.62491587 -0.6343671618  0.114043053 -0.54172092
Junior Mints                -0.16010610  1.6194428347  0.442156347 -0.08935729
Kit Kat                     -2.87086546  0.9069655335 -0.545771148 -2.94691419
Laffy Taffy                  1.65450042 -0.2379605144  1.217408326 -0.81578254
Lemonhead                    2.33564695 -1.2553404646  1.125823900 -1.18755633
Lifesavers big ring gummies  1.19528766 -0.0783610246  0.814040659 -0.61506538
Peanut butter M&amp;M's         -1.52223814  1.9291395890 -0.815897653  2.27060871
M&amp;M's                       -0.76747561  1.2573539136 -1.260658369  0.98037043
Mike &amp; Ike                   1.57487290  0.0664259746 -1.114406454  0.84284942
Milk Duds                   -0.76836937  0.4192793946 -0.137573021 -0.01222490
Milky Way                   -3.69272218 -2.4933313173  0.843423990  0.70792542
Milky Way Midnight          -3.23036513 -2.8201031327  0.902884388  0.75904764
Milky Way Simply Caramel    -3.04936226 -1.1774777304 -1.382617058  0.15488883
Mounds                      -1.81292795  0.2120726312  0.636094539 -0.91126847
Mr Good Bar                 -2.67327849  0.9217207344  0.997161433  0.40634715
Nerds                        1.93426895 -0.9133307225 -1.670281710  0.79359684
Nestle Butterfinger         -2.97855081  0.8798835368  0.348599786  0.94918411
Nestle Crunch               -2.92740488  0.8119013154 -0.747159803 -2.97250665
Nik L Nip                    1.63985272  0.4210217322 -0.083217936 -0.24015596
Now &amp; Later                  1.98070982  0.5117150919  0.460099768 -0.21340533
Payday                      -2.39180556 -1.4839637512  2.091687409  1.65680787
Peanut M&amp;Ms                 -1.38897069  2.0947188031 -0.260214925  1.89874716
Pixie Sticks                 1.67042227  0.8969792365  1.394703254 -0.48031281
Pop Rocks                    1.76879348 -0.8060325640 -1.567639814  0.42017068
Red vines                    2.12406849  0.1366822960 -0.115183020  0.27721045
Reese's Miniatures          -1.55210251  1.9287569793  1.884620322  0.48605155
Reese's Peanut Butter cup   -2.28427985  1.4648923293 -0.156138940  1.63994489
Reese's pieces              -1.40590761  2.3077984818  0.136661895  1.64348077
Reese's stuffed with pieces -2.13382398  1.0787289654 -0.673152403  1.96066081
Ring pop                     1.19274412 -1.7069749284 -1.423826969  0.02570015
Rolo                        -1.61259322  0.1773734932 -1.931879747  1.00697641
Root Beer Barrels            2.10440254 -0.8711340556 -0.594335570  0.36204105
Runts                        2.25699185 -1.1223199934 -1.557678507  0.71996790
Sixlets                      0.81799664  1.1888290122  1.093105891 -0.33001942
Skittles original            1.29259129  0.2263705137 -1.306145308  1.05900061
Skittles wildberry           1.47148517  0.1118354559 -1.232745536  0.99503181
Nestle Smarties             -0.27556563  1.3792344137 -0.080047831 -0.03345921
Smarties candy               2.60115214 -0.6047947520  0.003482896 -0.21938457
Snickers                    -4.39576792 -1.7919312516  1.434654778  1.89861891
Snickers Crisper            -4.01457335 -0.0347673522 -1.089868643 -1.42309414
Sour Patch Kids              1.81551769  0.8879445215  0.863881832 -0.32795118
Sour Patch Tricksters        1.97326660  0.7869473239  0.928605869 -0.38435897
Starburst                    1.50658493  0.9437290830  0.487658690 -0.12150268
Strawberry bon bons          2.80647837 -1.0331193111 -0.524069119  0.13960292
Sugar Babies                -0.01900559 -0.8219542293 -1.802826526  0.92212945
Sugar Daddy                  0.19642038 -1.2073694698  0.520140143 -0.59663517
Super Bubble                 1.99242820 -0.3915898648  1.481310204 -1.01767057
Swedish Fish                 1.00547407  0.5003327040 -1.068588828  0.59499272
Tootsie Pop                  0.84734171 -1.1060686710 -0.480874078 -0.23675349
Tootsie Roll Juniors        -0.40463667  0.5848580362  0.836999949 -0.59623669
Tootsie Roll Midgies         0.66730732  1.3709464980  1.179339290 -0.32789249
Tootsie Roll Snack Bars     -1.31149842  0.0009721286  0.885976952 -0.78242207
Trolli Sour Bites            1.85048456  0.5304055168  0.254559391 -0.02435072
Twix                        -4.12909044 -0.2180299573 -1.943536689 -2.52917855
Twizzlers                    1.56312584 -0.1794588354  1.179917535 -0.78310886
Warheads                     2.30707033 -1.2940268825  1.004249910 -1.11380521
Welch's Fruit Snacks         1.84808801  0.5022006184  0.213204782 -0.03387254
Werther's Original Caramel   0.68420363 -2.0146385440  0.506488679 -0.97208672
Whoppers                    -1.42549552  1.3654147702 -2.759982292 -1.23030133
                                    PC5          PC6         PC7          PC8
100 Grand                   -0.66236243 -0.545218405 -0.14340559  0.577224229
3 Musketeers                -0.16006665  0.382588420  2.02155526 -1.502574960
One dime                    -0.26977985  0.094950530 -0.77220066  0.155622104
One quarter                 -0.05093737  0.428354037 -0.59089199  0.359134372
Air Heads                    0.33108524  0.188791601  0.96808076  1.012393252
Almond Joy                   1.43200435  1.022273480 -0.66604596  0.608261288
Baby Ruth                   -0.53157179  0.026152894 -0.27477854  0.617961302
Boston Baked Beans          -0.01286555  1.147068667 -1.66290853  1.017203801
Candy Corn                  -0.92992691  0.482570575 -0.17268382 -0.433778134
Caramel Apple Pops          -1.26916612 -0.641471733 -0.77030933  1.705704289
Charleston Chew             -0.48839246  1.490541025  1.23825892 -1.445444979
Chewey Lemonhead Fruit Mix  -0.64216946  0.867070020  0.51175007  0.500258867
Chiclets                    -0.82031918  0.835939962 -0.06670709  0.514147274
Dots                        -0.57043885  0.625011322  0.68287986  0.487777458
Dum Dums                     1.60464382 -0.712637531 -0.06881335 -0.229647214
Fruit Chews                 -0.64943194 -0.515343269  0.62911226  0.295017216
Fun Dip                      1.64564645 -0.061325594 -0.22205535 -0.058799069
Gobstopper                   0.97535806  0.006638151  0.09322099 -0.594393205
Haribo Gold Bears           -0.41418743 -0.076745232  0.97316112  0.470072508
Haribo Happy Cola           -0.96450884  0.897177682 -0.57777493 -0.279999961
Haribo Sour Bears           -0.47964306  0.144138214  0.81700174  0.481462045
Haribo Twin Snakes          -0.58554144  0.501497845  0.56435691  0.499888780
Hershey's Kisses            -0.65415252 -0.956497265 -0.15459157 -1.475048333
Hershey's Krackel            0.64433919  0.815979037  0.72869731 -0.058197261
Hershey's Milk Chocolate     0.45257976  1.365951323  0.09727415 -0.537271619
Hershey's Special Dark       0.48406856  1.259690716  0.17239789 -0.542750795
Jawbusters                   0.74872541  0.777635266 -0.86953189 -0.404938915
Junior Mints                -0.56772916 -0.100807494 -0.27701048 -1.244289684
Kit Kat                      0.74560410 -0.651964126  1.26789202 -0.308264629
Laffy Taffy                  0.12742282 -0.323401158  0.50907401  0.902891431
Lemonhead                    1.59348201 -0.612577970 -0.46974919 -0.088239458
Lifesavers big ring gummies  0.28553918 -0.405905368  0.76717408  0.968451468
Peanut butter M&amp;M's          0.70534888 -0.535487043 -0.31945944 -0.055419751
M&amp;M's                       -0.42260375 -0.093849007  0.23580574 -1.272394704
Mike &amp; Ike                  -0.54748868  0.068855836  0.96217007  0.350296998
Milk Duds                   -1.94930706 -1.088570940 -1.46793514 -0.532609515
Milky Way                   -1.43541753 -0.603255019  0.91522507 -0.708957591
Milky Way Midnight          -1.60495490 -0.577210751  0.75050728 -0.825932767
Milky Way Simply Caramel    -0.81154750 -0.095588630 -0.56663709  0.057913957
Mounds                       0.34136052  1.562117376 -0.17156397 -0.536908890
Mr Good Bar                  1.49882941  1.178267833 -0.70645139  0.710404328
Nerds                        1.05269810 -0.612484674  0.36162582 -0.677966908
Nestle Butterfinger          1.66950147  0.246674393 -0.03583585  0.547351886
Nestle Crunch                0.66634611  0.310195315  0.85793736 -0.137897493
Nik L Nip                   -0.74139722  2.364290586 -0.37097983  0.877307522
Now &amp; Later                 -0.64458895  0.275284807  0.43215999  0.459054334
Payday                       0.57021053  1.685803617  0.71659189  0.920899230
Peanut M&amp;Ms                  0.67649842 -0.481270608 -0.49445201 -0.017712739
Pixie Sticks                -1.00053741 -0.249857693 -0.45261662 -0.491657159
Pop Rocks                    0.96236780  1.036365445 -0.40726527 -0.314719629
Red vines                   -0.69083254 -0.068691578  0.66734570  0.288409391
Reese's Miniatures           1.52874138 -1.896976303 -0.34129661  0.391227548
Reese's Peanut Butter cup    1.62984822 -1.101118658 -0.10711621  0.504507095
Reese's pieces               0.71687442 -0.652294629 -0.48369702  0.001608461
Reese's stuffed with pieces  1.50741757 -0.638134777 -0.27656579  0.488051492
Ring pop                     1.69809389  1.498435385 -0.64909630  0.323514628
Rolo                        -1.75944281 -0.678446043 -1.06073297 -0.430807299
Root Beer Barrels            0.42962062 -0.109312144 -1.19510153 -1.555611980
Runts                        0.90293644 -0.227471967  0.05500446 -0.683423916
Sixlets                     -0.89038600 -0.174585492 -0.66527067 -1.454385221
Skittles original           -0.37037605 -0.800924438  1.50687697  0.245536582
Skittles wildberry          -0.46191313 -0.492027764  1.28849431  0.261464394
Nestle Smarties             -0.71703419  1.677902657 -1.00236322 -0.943766974
Smarties candy               0.89831080 -0.766691658 -0.09224917 -0.697074269
Snickers                    -0.32409247 -0.999567686  0.29375023  0.519082351
Snickers Crisper             0.28905186 -0.982077142 -0.99809936  1.715122168
Sour Patch Kids             -0.44613213 -0.989653570  1.01684337  0.317967197
Sour Patch Tricksters       -0.52684967 -0.717267988  0.82427320  0.332012368
Starburst                   -0.34591253 -1.030380238  1.20373631  0.352584423
Strawberry bon bons          0.76654988 -0.423292666 -0.21835972 -0.752170933
Sugar Babies                -2.27338367  0.557052968 -1.67505130  0.548087948
Sugar Daddy                 -1.58729466 -0.485682924 -1.85240975  0.941435233
Super Bubble                -0.03565422  0.216125641  0.09347559  0.939439208
Swedish Fish                -0.39241423  0.662591135  0.83851208  0.624071063
Tootsie Pop                  1.88703233 -0.633721587 -0.18826747 -1.043909239
Tootsie Roll Juniors         0.05449315  0.394706045 -0.68468874 -0.662902544
Tootsie Roll Midgies        -0.77589776 -0.759442617 -0.35278919 -1.510639321
Tootsie Roll Snack Bars      0.28510912  0.328392863  0.22536722 -0.875755689
Trolli Sour Bites           -0.56414212 -0.168850396  0.72703429  0.389139607
Twix                        -0.49203516 -1.029755076  0.13814854  0.601927243
Twizzlers                    0.17417770 -0.481177950  0.62061848  0.894755897
Warheads                     1.59506307 -0.576609554 -0.45482313 -0.087796992
Welch's Fruit Snacks        -0.58742724  0.067119205  0.62144223  0.428665533
Werther's Original Caramel   0.00698052 -1.343145309 -2.51219819 -0.091968746
Whoppers                    -0.46170658  0.678567795  0.16799768 -0.639281286
                                     PC9         PC10         PC11
100 Grand                    0.379148201 -0.154099543  0.141903843
3 Musketeers                 0.023832701 -0.155239068 -0.517927160
One dime                    -0.453988975 -0.943783623 -0.515870807
One quarter                 -0.638889823  0.095579648 -0.986719399
Air Heads                   -1.383012190 -0.573723493 -0.514453684
Almond Joy                  -0.139059851 -0.312778705  1.061148660
Baby Ruth                    1.143067977  0.264099876 -0.009085882
Boston Baked Beans           1.396216830 -0.973188567  0.102073964
Candy Corn                  -0.173119296 -1.580718107 -0.026369468
Caramel Apple Pops          -0.916479426 -0.201217892  0.098522113
Charleston Chew              0.265940391 -0.852594237 -0.299018234
Chewey Lemonhead Fruit Mix  -0.056700856 -0.274516517  0.133783407
Chiclets                     0.600474625  0.299142845  0.263138381
Dots                        -0.109595061 -0.122162631  0.085957526
Dum Dums                    -0.385161810 -0.858986682  0.026635152
Fruit Chews                  0.431017129  0.094469913  0.405402342
Fun Dip                     -0.432729164 -0.348623806 -0.240086957
Gobstopper                   0.401434380  0.160051400  0.173108273
Haribo Gold Bears           -0.021735861  0.618649969 -0.035818163
Haribo Happy Cola            0.174940628 -0.664580531 -0.210044044
Haribo Sour Bears            0.026531168  0.479623974  0.007823919
Haribo Twin Snakes           0.104620713  0.254698661  0.078430922
Hershey's Kisses             0.015418665 -0.009459574  0.108560740
Hershey's Krackel            0.589905081 -0.259828939 -0.295461506
Hershey's Milk Chocolate    -1.211270861  0.556641044  0.566669950
Hershey's Special Dark      -1.234490726  0.623522410  0.545675013
Jawbusters                   1.175121068  1.211984587  0.107699541
Junior Mints                -0.125729538  0.657349544 -0.278384695
Kit Kat                      0.627262392 -0.428229606 -0.052463331
Laffy Taffy                 -0.694575541 -0.358253574 -0.196159662
Lemonhead                    0.133629280  0.441715610 -0.165939908
Lifesavers big ring gummies -0.856144679  0.130909678 -0.425911984
Peanut butter M&amp;M's          0.267660757 -0.221930007 -0.095957385
M&amp;M's                       -0.712293695  0.050005905 -0.359922697
Mike &amp; Ike                  -0.220487198 -0.593471988  0.252731956
Milk Duds                   -0.136911155  1.039501593  0.120288784
Milky Way                    0.004765911  0.843304841 -0.327048378
Milky Way Midnight           0.046247663 -0.050365745 -0.014682753
Milky Way Simply Caramel    -1.628250067  0.337544026  1.024026651
Mounds                      -1.038014053  0.444568191  0.664244259
Mr Good Bar                 -0.083279402  0.319687965  0.860817575
Nerds                        0.395546909  0.241504770  0.214795902
Nestle Butterfinger         -0.418486899 -0.056067346  0.931659519
Nestle Crunch                0.670459908 -0.224206267 -0.210210679
Nik L Nip                    0.390203352  1.144571263 -0.293659295
Now &amp; Later                  0.340332791  0.362285847  0.182098894
Payday                       1.592516886 -0.586376631 -0.517961675
Peanut M&amp;Ms                  0.463012748  0.130263439 -0.124891428
Pixie Sticks                 0.506958178 -0.721036477  0.100340132
Pop Rocks                    0.614743430  1.229233468 -0.196822517
Red vines                    0.116010128 -0.683310675  0.459814126
Reese's Miniatures          -0.201912762  0.339292365 -0.538620165
Reese's Peanut Butter cup   -0.813354976 -0.127457497 -0.769615618
Reese's pieces               0.573552037  0.549292897 -0.190638431
Reese's stuffed with pieces -0.924164172 -0.865127171 -0.632341326
Ring pop                    -0.509522417  0.693685961 -0.801535980
Rolo                        -0.716390425  0.955937401 -0.177541179
Root Beer Barrels            0.748159981 -1.361887249  0.275586696
Runts                        0.490713003 -0.186267132  0.357472263
Sixlets                      0.120551003 -0.694412596  0.295248736
Skittles original           -0.396609466 -0.492989386  0.235345367
Skittles wildberry          -0.329109954 -0.687411685  0.296377074
Nestle Smarties             -0.095850762  0.891841882 -0.546823295
Smarties candy               0.957784710  0.645048933  0.369028845
Snickers                     1.040500931  0.639420129 -0.064039216
Snickers Crisper             1.597773064 -0.876877339  0.668926998
Sour Patch Kids              0.319739180  0.748914211  0.190355889
Sour Patch Tricksters        0.379260358  0.577472316  0.244173747
Starburst                    0.178115491  0.966910650  0.055007728
Strawberry bon bons          0.831798717 -0.257396978  0.567295681
Sugar Babies                -0.204221618 -0.392704656 -0.026264253
Sugar Daddy                 -0.751459910 -0.659787353 -0.269135682
Super Bubble                -0.530802993 -0.601257076 -0.099471654
Swedish Fish                -0.159360361  0.838989403 -0.260036175
Tootsie Pop                 -0.721118894  0.326836317 -0.137911107
Tootsie Roll Juniors        -1.149669881 -0.284072969 -0.704615875
Tootsie Roll Midgies         0.074811904 -0.471079914  0.266947340
Tootsie Roll Snack Bars     -1.078720446 -0.723988086  1.173413519
Trolli Sour Bites            0.215399333  0.265589321  0.205354764
Twix                         0.390371217  0.606070076 -0.048120393
Twizzlers                   -0.729052624 -0.258947465 -0.227333151
Warheads                     0.096482954  0.378764818 -0.167107014
Welch's Fruit Snacks         0.229115315  0.300496305  0.173167709
Werther's Original Caramel   0.028457521  0.448967578 -0.298604763
Whoppers                     1.212121185 -1.054026246 -1.220426934
                                     PC12
100 Grand                    0.0646988318
3 Musketeers                -0.1839471662
One dime                    -0.5107477914
One quarter                 -0.9582719109
Air Heads                    0.0442992399
Almond Joy                   0.1889347102
Baby Ruth                    0.5798508261
Boston Baked Beans          -0.1012981497
Candy Corn                  -0.6799350975
Caramel Apple Pops           0.6962504166
Charleston Chew              0.5494017342
Chewey Lemonhead Fruit Mix   0.3105973331
Chiclets                     0.5337581991
Dots                         0.1503797578
Dum Dums                     0.1849692597
Fruit Chews                  0.1399898762
Fun Dip                      0.1237990873
Gobstopper                  -0.1944414618
Haribo Gold Bears           -0.2638818244
Haribo Happy Cola           -0.6879064447
Haribo Sour Bears           -0.1176800541
Haribo Twin Snakes           0.1188546962
Hershey's Kisses             0.1984492942
Hershey's Krackel           -0.0817067486
Hershey's Milk Chocolate    -0.3573702410
Hershey's Special Dark      -0.4277036644
Jawbusters                   0.1337584661
Junior Mints                 0.0649489483
Kit Kat                     -0.3769186469
Laffy Taffy                  0.3026020451
Lemonhead                    0.0619011170
Lifesavers big ring gummies -0.0228900695
Peanut butter M&amp;M's          0.1200218111
M&amp;M's                       -0.1023879726
Mike &amp; Ike                   0.1113757406
Milk Duds                    0.3400578947
Milky Way                   -0.1552479006
Milky Way Midnight           0.2304632793
Milky Way Simply Caramel    -0.2533060125
Mounds                      -0.1415021722
Mr Good Bar                  0.0210418054
Nerds                       -0.3936975444
Nestle Butterfinger         -0.3100685916
Nestle Crunch               -0.1731325150
Nik L Nip                    0.4597035356
Now &amp; Later                  0.1806417362
Payday                      -0.7729766006
Peanut M&amp;Ms                  0.1319358415
Pixie Sticks                -0.7378511713
Pop Rocks                   -0.1936682261
Red vines                    0.3438211129
Reese's Miniatures          -0.0689054242
Reese's Peanut Butter cup   -0.1005437626
Reese's pieces              -0.0005861225
Reese's stuffed with pieces  0.2335945192
Ring pop                     0.0735408387
Rolo                         0.0787870205
Root Beer Barrels           -0.7082327026
Runts                       -0.0585635801
Sixlets                      0.7459023430
Skittles original           -0.2795750540
Skittles wildberry          -0.0751177198
Nestle Smarties              0.4628839641
Smarties candy              -0.2022435492
Snickers                     0.0911696493
Snickers Crisper             0.6306015108
Sour Patch Kids             -0.3186623415
Sour Patch Tricksters       -0.1383715363
Starburst                   -0.5130782116
Strawberry bon bons          0.1543709171
Sugar Babies                -0.4541934821
Sugar Daddy                 -0.2885121237
Super Bubble                 0.6537195364
Swedish Fish                -0.2507351031
Tootsie Pop                  1.2506316262
Tootsie Roll Juniors         0.5695856300
Tootsie Roll Midgies         0.4724506497
Tootsie Roll Snack Bars     -0.0373596827
Trolli Sour Bites            0.0146955266
Twix                        -0.3530484324
Twizzlers                    0.1981702880
Warheads                     0.0702649429
Welch's Fruit Snacks         0.0727669700
Werther's Original Caramel  -0.8335356607
Whoppers                     0.7201599382</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span>], pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">col =</span> my_cols, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab09_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(candy.data, pca<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(my_data) <span class="sc">+</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2, </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">size=</span>winpercent<span class="sc">/</span><span class="dv">100</span>,  </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">text=</span><span class="fu">rownames</span>(my_data),</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">label=</span><span class="fu">rownames</span>(my_data)) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="at">col=</span>my_cols)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab09_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let’s add repel to this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_text_repel</span>(<span class="at">size=</span><span class="fl">3.3</span>, <span class="at">col=</span>my_cols, <span class="at">max.overlaps =</span> <span class="dv">7</span>)  <span class="sc">+</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Halloween Candy PCA Space"</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Colored by type: chocolate bar (brown), chocolate other (blue), fruity (pink), other (grey)"</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"Data from 538"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ggrepel: 40 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lab09_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-9a70aed8345148d462bb" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9a70aed8345148d462bb">{"x":{"data":[{"x":[-3.8198617450338817,-2.7960236395023137,1.2025836315339853,0.44865377872929912,0.70289922101263624,-2.4683383374455432,-4.1053122278249061,0.71385812911879898,1.013572041268227,0.81049644709198343,-2.1543658740121518,1.6526848199514981,2.3818081662045802,1.5124993621205056,2.1443093258381665,2.2613376304884381,1.8238334838391475,1.9604781160418916,1.3336074637748283,1.1116736451286773,1.4615295226573071,1.6684901647770922,0.37722674851876503,-3.0478835644961495,-2.1169641707883944,-2.178503756202709,2.6249158673699649,-0.16010609998878389,-2.8708654644150067,1.654500418804288,2.3356469520707188,1.1952876648295445,-1.5222381444208088,-0.76747560629035938,1.5748729015402887,-0.76836937030615593,-3.6927221838214166,-3.2303651268152223,-3.0493622631808108,-1.8129279465958597,-2.6732784917460641,1.934268949348287,-2.9785508125316489,-2.9274048760239704,1.6398527213514751,1.9807098230419466,-2.3918055607741122,-1.3889706898085157,1.6704222745082375,1.7687934829190699,2.1240684877673268,-1.5521025097162922,-2.2842798483348679,-1.4059076089204237,-2.133823982845672,1.1927441238739036,-1.6125932233170017,2.1044025437438392,2.2569918487530414,0.81799664349647339,1.2925912853784409,1.4714851736125243,-0.27556562513355332,2.6011521390625916,-4.3957679187957579,-4.014573347937036,1.8155176864056142,1.973266603923655,1.5065849329187186,2.8064783733762035,-0.01900558874083691,0.19642038204206072,1.9924282012383734,1.0054740661616877,0.84734171246030976,-0.40463666537327625,0.66730732389627334,-1.3114984201784623,1.8504845635693874,-4.1290904398299473,1.5631258385733784,2.30707033004499,1.8480880095264376,0.68420363241620274,-1.4254955249731791],"y":[-0.59357876699123968,-1.5196062111490962,0.17181206565381635,0.45197356214953693,-0.57313432631882844,0.70355011200463324,-2.1000967736150118,1.2098216536797293,0.28343196211930766,-1.6960889498264915,-1.9304213037340614,0.072643494363980293,0.44309260707363551,0.16239585915288252,-1.838838615970682,0.58183225199363553,-1.7828662094011527,-1.0584680266894526,0.58926999209087483,0.62576978075165268,0.50736914823009771,0.37486462646383384,1.5654519145145847,0.68507927870814189,0.25045688907749347,0.28985700521309343,-0.63436716178127672,1.6194428346907055,0.90696553350408426,-0.23796051440696281,-1.2553404646305339,-0.078361024580055477,1.9291395889859038,1.2573539135514831,0.066425974582063854,0.41927939455434005,-2.4933313172941847,-2.8201031326663442,-1.1774777304496618,0.21207263122389605,0.92172073441267088,-0.91333072245625357,0.87988353679582554,0.81190131536812027,0.42102173223310191,0.51171509192832332,-1.4839637512177126,2.0947188031081185,0.89697923645043598,-0.80603256401220413,0.13668229597088857,1.9287569792771055,1.4648923293464871,2.3077984818203481,1.0787289653625503,-1.7069749283502003,0.17737349316929596,-0.87113405557910384,-1.122319993390829,1.1888290121999996,0.2263705137053528,0.11183545590607775,1.3792344137274362,-0.60479475204908728,-1.7919312516198425,-0.034767352242739885,0.88794452152157211,0.78694732388640132,0.9437290830037347,-1.0331193111443089,-0.82195422930652629,-1.2073694698280661,-0.39158986476601293,0.50033270400462349,-1.1060686710295071,0.5848580362025545,1.370946497982231,0.00097212857498498069,0.53040551680395076,-0.21802995732963038,-0.1794588353868419,-1.2940268824869703,0.50220061837795449,-2.0146385440068406,1.3654147702341568],"text":["PC1: -3.81986175<br />PC2: -0.5935787670<br />winpercent/100: 0.6697173<br />100 Grand<br />rownames(my_data): 100 Grand","PC1: -2.79602364<br />PC2: -1.5196062111<br />winpercent/100: 0.6760294<br />3 Musketeers<br />rownames(my_data): 3 Musketeers","PC1:  1.20258363<br />PC2:  0.1718120657<br />winpercent/100: 0.3226109<br />One dime<br />rownames(my_data): One dime","PC1:  0.44865378<br />PC2:  0.4519735621<br />winpercent/100: 0.4611650<br />One quarter<br />rownames(my_data): One quarter","PC1:  0.70289922<br />PC2: -0.5731343263<br />winpercent/100: 0.5234146<br />Air Heads<br />rownames(my_data): Air Heads","PC1: -2.46833834<br />PC2:  0.7035501120<br />winpercent/100: 0.5034755<br />Almond Joy<br />rownames(my_data): Almond Joy","PC1: -4.10531223<br />PC2: -2.1000967736<br />winpercent/100: 0.5691455<br />Baby Ruth<br />rownames(my_data): Baby Ruth","PC1:  0.71385813<br />PC2:  1.2098216537<br />winpercent/100: 0.2341782<br />Boston Baked Beans<br />rownames(my_data): Boston Baked Beans","PC1:  1.01357204<br />PC2:  0.2834319621<br />winpercent/100: 0.3801096<br />Candy Corn<br />rownames(my_data): Candy Corn","PC1:  0.81049645<br />PC2: -1.6960889498<br />winpercent/100: 0.3451768<br />Caramel Apple Pops<br />rownames(my_data): Caramel Apple Pops","PC1: -2.15436587<br />PC2: -1.9304213037<br />winpercent/100: 0.3897504<br />Charleston Chew<br />rownames(my_data): Charleston Chew","PC1:  1.65268482<br />PC2:  0.0726434944<br />winpercent/100: 0.3601763<br />Chewey Lemonhead Fruit Mix<br />rownames(my_data): Chewey Lemonhead Fruit Mix","PC1:  2.38180817<br />PC2:  0.4430926071<br />winpercent/100: 0.2452499<br />Chiclets<br />rownames(my_data): Chiclets","PC1:  1.51249936<br />PC2:  0.1623958592<br />winpercent/100: 0.4227208<br />Dots<br />rownames(my_data): Dots","PC1:  2.14430933<br />PC2: -1.8388386160<br />winpercent/100: 0.3946056<br />Dum Dums<br />rownames(my_data): Dum Dums","PC1:  2.26133763<br />PC2:  0.5818322520<br />winpercent/100: 0.4308892<br />Fruit Chews<br />rownames(my_data): Fruit Chews","PC1:  1.82383348<br />PC2: -1.7828662094<br />winpercent/100: 0.3918550<br />Fun Dip<br />rownames(my_data): Fun Dip","PC1:  1.96047812<br />PC2: -1.0584680267<br />winpercent/100: 0.4678335<br />Gobstopper<br />rownames(my_data): Gobstopper","PC1:  1.33360746<br />PC2:  0.5892699921<br />winpercent/100: 0.5711974<br />Haribo Gold Bears<br />rownames(my_data): Haribo Gold Bears","PC1:  1.11167365<br />PC2:  0.6257697808<br />winpercent/100: 0.3415896<br />Haribo Happy Cola<br />rownames(my_data): Haribo Happy Cola","PC1:  1.46152952<br />PC2:  0.5073691482<br />winpercent/100: 0.5141243<br />Haribo Sour Bears<br />rownames(my_data): Haribo Sour Bears","PC1:  1.66849016<br />PC2:  0.3748646265<br />winpercent/100: 0.4217877<br />Haribo Twin Snakes<br />rownames(my_data): Haribo Twin Snakes","PC1:  0.37722675<br />PC2:  1.5654519145<br />winpercent/100: 0.5537545<br />Hershey's Kisses<br />rownames(my_data): Hershey's Kisses","PC1: -3.04788356<br />PC2:  0.6850792787<br />winpercent/100: 0.6228448<br />Hershey's Krackel<br />rownames(my_data): Hershey's Krackel","PC1: -2.11696417<br />PC2:  0.2504568891<br />winpercent/100: 0.5649050<br />Hershey's Milk Chocolate<br />rownames(my_data): Hershey's Milk Chocolate","PC1: -2.17850376<br />PC2:  0.2898570052<br />winpercent/100: 0.5923612<br />Hershey's Special Dark<br />rownames(my_data): Hershey's Special Dark","PC1:  2.62491587<br />PC2: -0.6343671618<br />winpercent/100: 0.2812744<br />Jawbusters<br />rownames(my_data): Jawbusters","PC1: -0.16010610<br />PC2:  1.6194428347<br />winpercent/100: 0.5721925<br />Junior Mints<br />rownames(my_data): Junior Mints","PC1: -2.87086546<br />PC2:  0.9069655335<br />winpercent/100: 0.7676860<br />Kit Kat<br />rownames(my_data): Kit Kat","PC1:  1.65450042<br />PC2: -0.2379605144<br />winpercent/100: 0.4138956<br />Laffy Taffy<br />rownames(my_data): Laffy Taffy","PC1:  2.33564695<br />PC2: -1.2553404646<br />winpercent/100: 0.3914106<br />Lemonhead<br />rownames(my_data): Lemonhead","PC1:  1.19528766<br />PC2: -0.0783610246<br />winpercent/100: 0.5291139<br />Lifesavers big ring gummies<br />rownames(my_data): Lifesavers big ring gummies","PC1: -1.52223814<br />PC2:  1.9291395890<br />winpercent/100: 0.7146505<br />Peanut butter M&M's<br />rownames(my_data): Peanut butter M&M's","PC1: -0.76747561<br />PC2:  1.2573539136<br />winpercent/100: 0.6657458<br />M&M's<br />rownames(my_data): M&M's","PC1:  1.57487290<br />PC2:  0.0664259746<br />winpercent/100: 0.4641172<br />Mike & Ike<br />rownames(my_data): Mike & Ike","PC1: -0.76836937<br />PC2:  0.4192793946<br />winpercent/100: 0.5506407<br />Milk Duds<br />rownames(my_data): Milk Duds","PC1: -3.69272218<br />PC2: -2.4933313173<br />winpercent/100: 0.7309956<br />Milky Way<br />rownames(my_data): Milky Way","PC1: -3.23036513<br />PC2: -2.8201031327<br />winpercent/100: 0.6080070<br />Milky Way Midnight<br />rownames(my_data): Milky Way Midnight","PC1: -3.04936226<br />PC2: -1.1774777304<br />winpercent/100: 0.6435334<br />Milky Way Simply Caramel<br />rownames(my_data): Milky Way Simply Caramel","PC1: -1.81292795<br />PC2:  0.2120726312<br />winpercent/100: 0.4782975<br />Mounds<br />rownames(my_data): Mounds","PC1: -2.67327849<br />PC2:  0.9217207344<br />winpercent/100: 0.5452645<br />Mr Good Bar<br />rownames(my_data): Mr Good Bar","PC1:  1.93426895<br />PC2: -0.9133307225<br />winpercent/100: 0.5535405<br />Nerds<br />rownames(my_data): Nerds","PC1: -2.97855081<br />PC2:  0.8798835368<br />winpercent/100: 0.7073564<br />Nestle Butterfinger<br />rownames(my_data): Nestle Butterfinger","PC1: -2.92740488<br />PC2:  0.8119013154<br />winpercent/100: 0.6647068<br />Nestle Crunch<br />rownames(my_data): Nestle Crunch","PC1:  1.63985272<br />PC2:  0.4210217322<br />winpercent/100: 0.2244534<br />Nik L Nip<br />rownames(my_data): Nik L Nip","PC1:  1.98070982<br />PC2:  0.5117150919<br />winpercent/100: 0.3944680<br />Now & Later<br />rownames(my_data): Now & Later","PC1: -2.39180556<br />PC2: -1.4839637512<br />winpercent/100: 0.4629660<br />Payday<br />rownames(my_data): Payday","PC1: -1.38897069<br />PC2:  2.0947188031<br />winpercent/100: 0.6948379<br />Peanut M&Ms<br />rownames(my_data): Peanut M&Ms","PC1:  1.67042227<br />PC2:  0.8969792365<br />winpercent/100: 0.3772234<br />Pixie Sticks<br />rownames(my_data): Pixie Sticks","PC1:  1.76879348<br />PC2: -0.8060325640<br />winpercent/100: 0.4126551<br />Pop Rocks<br />rownames(my_data): Pop Rocks","PC1:  2.12406849<br />PC2:  0.1366822960<br />winpercent/100: 0.3734852<br />Red vines<br />rownames(my_data): Red vines","PC1: -1.55210251<br />PC2:  1.9287569793<br />winpercent/100: 0.8186626<br />Reese's Miniatures<br />rownames(my_data): Reese's Miniatures","PC1: -2.28427985<br />PC2:  1.4648923293<br />winpercent/100: 0.8418029<br />Reese's Peanut Butter cup<br />rownames(my_data): Reese's Peanut Butter cup","PC1: -1.40590761<br />PC2:  2.3077984818<br />winpercent/100: 0.7343499<br />Reese's pieces<br />rownames(my_data): Reese's pieces","PC1: -2.13382398<br />PC2:  1.0787289654<br />winpercent/100: 0.7288790<br />Reese's stuffed with pieces<br />rownames(my_data): Reese's stuffed with pieces","PC1:  1.19274412<br />PC2: -1.7069749284<br />winpercent/100: 0.3529076<br />Ring pop<br />rownames(my_data): Ring pop","PC1: -1.61259322<br />PC2:  0.1773734932<br />winpercent/100: 0.6571629<br />Rolo<br />rownames(my_data): Rolo","PC1:  2.10440254<br />PC2: -0.8711340556<br />winpercent/100: 0.2970369<br />Root Beer Barrels<br />rownames(my_data): Root Beer Barrels","PC1:  2.25699185<br />PC2: -1.1223199934<br />winpercent/100: 0.4284914<br />Runts<br />rownames(my_data): Runts","PC1:  0.81799664<br />PC2:  1.1888290122<br />winpercent/100: 0.3472200<br />Sixlets<br />rownames(my_data): Sixlets","PC1:  1.29259129<br />PC2:  0.2263705137<br />winpercent/100: 0.6308514<br />Skittles original<br />rownames(my_data): Skittles original","PC1:  1.47148517<br />PC2:  0.1118354559<br />winpercent/100: 0.5510369<br />Skittles wildberry<br />rownames(my_data): Skittles wildberry","PC1: -0.27556563<br />PC2:  1.3792344137<br />winpercent/100: 0.3788719<br />Nestle Smarties<br />rownames(my_data): Nestle Smarties","PC1:  2.60115214<br />PC2: -0.6047947520<br />winpercent/100: 0.4599583<br />Smarties candy<br />rownames(my_data): Smarties candy","PC1: -4.39576792<br />PC2: -1.7919312516<br />winpercent/100: 0.7667378<br />Snickers<br />rownames(my_data): Snickers","PC1: -4.01457335<br />PC2: -0.0347673522<br />winpercent/100: 0.5952925<br />Snickers Crisper<br />rownames(my_data): Snickers Crisper","PC1:  1.81551769<br />PC2:  0.8879445215<br />winpercent/100: 0.5986400<br />Sour Patch Kids<br />rownames(my_data): Sour Patch Kids","PC1:  1.97326660<br />PC2:  0.7869473239<br />winpercent/100: 0.5282595<br />Sour Patch Tricksters<br />rownames(my_data): Sour Patch Tricksters","PC1:  1.50658493<br />PC2:  0.9437290830<br />winpercent/100: 0.6703763<br />Starburst<br />rownames(my_data): Starburst","PC1:  2.80647837<br />PC2: -1.0331193111<br />winpercent/100: 0.3457899<br />Strawberry bon bons<br />rownames(my_data): Strawberry bon bons","PC1: -0.01900559<br />PC2: -0.8219542293<br />winpercent/100: 0.3343755<br />Sugar Babies<br />rownames(my_data): Sugar Babies","PC1:  0.19642038<br />PC2: -1.2073694698<br />winpercent/100: 0.3223100<br />Sugar Daddy<br />rownames(my_data): Sugar Daddy","PC1:  1.99242820<br />PC2: -0.3915898648<br />winpercent/100: 0.2730386<br />Super Bubble<br />rownames(my_data): Super Bubble","PC1:  1.00547407<br />PC2:  0.5003327040<br />winpercent/100: 0.5486111<br />Swedish Fish<br />rownames(my_data): Swedish Fish","PC1:  0.84734171<br />PC2: -1.1060686710<br />winpercent/100: 0.4898265<br />Tootsie Pop<br />rownames(my_data): Tootsie Pop","PC1: -0.40463667<br />PC2:  0.5848580362<br />winpercent/100: 0.4306890<br />Tootsie Roll Juniors<br />rownames(my_data): Tootsie Roll Juniors","PC1:  0.66730732<br />PC2:  1.3709464980<br />winpercent/100: 0.4573675<br />Tootsie Roll Midgies<br />rownames(my_data): Tootsie Roll Midgies","PC1: -1.31149842<br />PC2:  0.0009721286<br />winpercent/100: 0.4965350<br />Tootsie Roll Snack Bars<br />rownames(my_data): Tootsie Roll Snack Bars","PC1:  1.85048456<br />PC2:  0.5304055168<br />winpercent/100: 0.4717323<br />Trolli Sour Bites<br />rownames(my_data): Trolli Sour Bites","PC1: -4.12909044<br />PC2: -0.2180299573<br />winpercent/100: 0.8164291<br />Twix<br />rownames(my_data): Twix","PC1:  1.56312584<br />PC2: -0.1794588354<br />winpercent/100: 0.4546628<br />Twizzlers<br />rownames(my_data): Twizzlers","PC1:  2.30707033<br />PC2: -1.2940268825<br />winpercent/100: 0.3901190<br />Warheads<br />rownames(my_data): Warheads","PC1:  1.84808801<br />PC2:  0.5022006184<br />winpercent/100: 0.4437552<br />Welch's Fruit Snacks<br />rownames(my_data): Welch's Fruit Snacks","PC1:  0.68420363<br />PC2: -2.0146385440<br />winpercent/100: 0.4190431<br />Werther's Original Caramel<br />rownames(my_data): Werther's Original Caramel","PC1: -1.42549552<br />PC2:  1.3654147702<br />winpercent/100: 0.4952411<br />Whoppers<br />rownames(my_data): Whoppers"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":["rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(190,190,190,1)","rgba(190,190,190,1)","rgba(255,105,180,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(190,190,190,1)","rgba(190,190,190,1)","rgba(255,105,180,1)","rgba(30,144,255,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(190,190,190,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(30,144,255,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(165,42,42,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(255,105,180,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(30,144,255,1)","rgba(165,42,42,1)","rgba(190,190,190,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(165,42,42,1)","rgba(165,42,42,1)","rgba(165,42,42,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(190,190,190,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(255,105,180,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(190,190,190,1)","rgba(190,190,190,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(165,42,42,1)","rgba(30,144,255,1)","rgba(255,105,180,1)","rgba(30,144,255,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(190,190,190,1)","rgba(165,42,42,1)"],"opacity":1,"size":[19.828627725370275,19.941984319750745,11.314880656547571,15.481303576751872,16.930244105548791,16.484134594815721,17.900272666104886,6.1513544191163154,13.268631717585256,12.136283196529833,13.558076351961677,12.6402369136879,7.2479883217543106,14.488987603289399,13.700647372194114,14.707372216994584,13.620133203251825,15.644984830742168,17.942240251785197,12.011188691622834,16.724299417829293,14.463758693258258,17.581418277695441,18.960407698580422,17.813145978190153,18.368055701191199,9.5127175473046268,17.96254805653075,21.50651276191503,14.247927162561822,13.607059979498962,17.055002164064962,20.61895567351322,19.756894800114495,15.554045861588005,17.516009025138441,20.897399322815147,18.675024806269022,19.349592943727746,15.897376557849205,17.402336543296304,17.576931215749674,20.493201505700164,19.738073871370162,3.7795275590551185,13.696636182247577,15.525733227842068,20.275140640737121,13.180243764768324,14.213597533381357,13.064518020284071,22.319609322232719,22.677165354330711,20.953983377552241,20.861598987402733,12.39970178751039,19.600754635727014,10.259317495109034,14.643722125579757,12.206703679146875,19.112196180707198,17.524349561389624,13.230828600011638,15.451437040701942,21.491035308933039,18.426057141542458,18.492013876273006,17.036372913844975,19.840500380144245,12.157476429670227,11.753678691933704,11.303321658506617,9.0809712154395346,17.473206618105284,16.169502350938579,14.702070204995396,15.387058129122941,16.325131596709078,15.73964616303534,22.284733591160411,15.319466470168813,13.568973296550341,15.042760141550163,14.389197283895959,16.295265371189366],"symbol":"circle","line":{"width":1.8897637795275593,"color":["rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(190,190,190,1)","rgba(190,190,190,1)","rgba(255,105,180,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(190,190,190,1)","rgba(190,190,190,1)","rgba(255,105,180,1)","rgba(30,144,255,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(190,190,190,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(30,144,255,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(165,42,42,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(255,105,180,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(30,144,255,1)","rgba(165,42,42,1)","rgba(190,190,190,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(165,42,42,1)","rgba(165,42,42,1)","rgba(165,42,42,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(190,190,190,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(255,105,180,1)","rgba(30,144,255,1)","rgba(30,144,255,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(190,190,190,1)","rgba(190,190,190,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(165,42,42,1)","rgba(165,42,42,1)","rgba(30,144,255,1)","rgba(255,105,180,1)","rgba(30,144,255,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(255,105,180,1)","rgba(190,190,190,1)","rgba(165,42,42,1)"]}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283104,"r":7.3059360730593621,"b":40.182648401826491,"l":37.260273972602747},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-4.7558802334043557,3.1665906879848018],"tickmode":"array","ticktext":["-2.5","0.0","2.5"],"tickvals":[-2.5,0,2.5],"categoryorder":"array","categoryarray":["-2.5","0.0","2.5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"PC1","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.0764982133906789,2.5641935625446828],"tickmode":"array","ticktext":["-3","-2","-1","0","1","2"],"tickvals":[-3,-2,-1,0,0.99999999999999956,1.9999999999999996],"categoryorder":"array","categoryarray":["-3","-2","-1","0","1","2"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"PC2","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"winpercent/100","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"2f044a0812f":{"x":{},"y":{},"size":{},"text":{},"label":{},"type":"scatter"}},"cur_data":"2f044a0812f","visdat":{"2f044a0812f":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>How do the original variables contribute to our PCs? For this we look at the loading component of our results object i.e.&nbsp;<code>pca$rotation</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>pca<span class="sc">$</span>rotation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        PC1         PC2         PC3          PC4          PC5
chocolate        -0.4019466  0.21404160  0.01601358 -0.016673032  0.066035846
fruity            0.3683883 -0.18304666 -0.13765612 -0.004479829  0.143535325
caramel          -0.2299709 -0.40349894 -0.13294166 -0.024889542 -0.507301501
peanutyalmondy   -0.2407155  0.22446919  0.18272802  0.466784287  0.399930245
nougat           -0.2268102 -0.47016599  0.33970244  0.299581403 -0.188852418
crispedricewafer -0.2215182  0.09719527 -0.36485542 -0.605594730  0.034652316
hard              0.2111587 -0.43262603 -0.20295368 -0.032249660  0.574557816
bar              -0.3947433 -0.22255618  0.10696092 -0.186914549  0.077794806
pluribus          0.2600041  0.36920922 -0.26813772  0.287246604 -0.392796479
sugarpercent     -0.1083088 -0.23647379 -0.65509692  0.433896248  0.007469103
pricepercent     -0.3207361  0.05883628 -0.33048843  0.063557149  0.043358887
winpercent       -0.3298035  0.21115347 -0.13531766  0.117930997  0.168755073
                         PC6         PC7         PC8          PC9         PC10
chocolate        -0.09018950 -0.08360642 -0.49084856 -0.151651568  0.107661356
fruity           -0.04266105  0.46147889  0.39805802 -0.001248306  0.362062502
caramel          -0.40346502 -0.44274741  0.26963447  0.019186442  0.229799010
peanutyalmondy   -0.09416259 -0.25710489  0.45771445  0.381068550 -0.145912362
nougat            0.09012643  0.36663902 -0.18793955  0.385278987  0.011323453
crispedricewafer -0.09007640  0.13077042  0.13567736  0.511634999 -0.264810144
hard             -0.12767365 -0.31933477 -0.38881683  0.258154433  0.220779142
bar               0.25307332  0.24192992 -0.02982691  0.091872886 -0.003232321
pluribus          0.03184932  0.04066352 -0.28652547  0.529954405  0.199303452
sugarpercent      0.02737834  0.14721840 -0.04114076 -0.217685759 -0.488103337
pricepercent      0.62908570 -0.14308215  0.16722078 -0.048991557  0.507716043
winpercent       -0.56947283  0.40260385 -0.02936405 -0.124440117  0.358431235
                        PC11        PC12
chocolate         0.10045278  0.69784924
fruity            0.17494902  0.50624242
caramel           0.13515820  0.07548984
peanutyalmondy    0.11244275  0.12972756
nougat           -0.38954473  0.09223698
crispedricewafer -0.22615618  0.11727369
hard              0.01342330 -0.10430092
bar               0.74956878 -0.22010569
pluribus          0.27971527 -0.06169246
sugarpercent      0.05373286  0.04733985
pricepercent     -0.26396582 -0.06698291
winpercent       -0.11251626 -0.37693153</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(pca<span class="sc">$</span>rotation[,<span class="dv">1</span>], <span class="at">las=</span><span class="dv">2</span>, <span class="at">ylab=</span><span class="st">"PC1 Contribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab09_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">as.data.frame</span>(pca<span class="sc">$</span>rotation)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res) <span class="sc">+</span> <span class="fu">aes</span>(PC1, <span class="fu">reorder</span>(<span class="fu">row.names</span>(res), PC1)) <span class="sc">+</span> <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab09_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Q24. What original variables are picked up strongly by PC1 in the positive direction? Do these make sense to you?</p>
</blockquote>
<p>Fruity, hard, and pluribus are picked up strongly by PC1. Makes sense because these are generally correlated with fruity candy while the other stuff is more correlated to chocolate candy.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>